<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>VivaGraphs test page</title>
        <script type="text/javascript" src="resource/script/vivajs/vivagraph.js"></script>
    

        <script type='text/javascript'>
            /*global Viva*/
            function onLoad() {
                var nodeList = [["229", "Kho LV - Long Xuy\u00ean", "kho_tong", "10.3627411", "105.4416804"], ["241", "Kho LV - Bu\u00f4n Ma Thu\u1ed9t", "kho_tong", "12.7229315", "108.0976633"], ["247", "Kho LV - \u0110\u1ee9c Tr\u1ecdng", "kho_tong", "11.641927", "108.3102916"], ["262", "Kho LV - Cam Ranh", "kho_tong", "11.9008657", "109.140438"], ["274", "Kho LV - C\u1ea7n Th\u01a1", "kho_tong", "10.023423", "105.7865625"], ["286", "Kho Bi\u00ean H\u00f2a 2", "kho_tong", "10.9574128", "106.8426871"], ["505", "N\u1ed9i B\u00e0i - T\u00e2n S\u01a1n Nh\u1ea5t", "kho_tong", "21.21301", "105.800558"], ["513", "S\u00e2n Bay N\u1ed9i B\u00e0i", "kho_tong", "21.21302", "105.800559"], ["517", "S\u00e2n Bay \u0110\u00e0 N\u1eb5ng", "kho_tong", "16.0392439", "108.2388634"], ["521", "S\u00e2n Bay C\u1ea7n Th\u01a1", "kho_tong", "10.0804831", "105.7099836"], ["525", "S\u00e2n bay C\u00e1t Bi", "kho_tong", "20.8213833", "106.7240461"], ["529", "S\u00e2n bay Cam Ranh", "kho_tong", "12.0070805", "109.2146377"], ["533", "S\u00e2n bay Li\u00ean Kh\u01b0\u01a1ng", "kho_tong", "11.750342", "108.365986"], ["617", "Kho H\u00e0m Nghi (HN)", "kho_tong", "21.0399026", "105.7618237"], ["657", "Kho Ph\u00f9 L\u1ed7 (HN)", "kho_tong", "21.2327247", "105.8128851"], ["705", "Kho Ph\u1ea1m V\u0103n \u0110\u1ed3ng - HN", "kho_tong", "21.074629", "105.785379"], ["857", "S\u00e2n bay T\u00e2n S\u01a1n Nh\u1ea5t", "kho_tong", "11.750342", "108.36818"], ["861", "S\u00e2n bay Bu\u00f4n Ma Thu\u1ed9t", "kho_tong", "12.664714", "108.117223"], ["1121", "Kho C\u1ee7 Chi (HCM)", "kho_tong", "10.928198", "106.5548679"], ["1256", "Kho LV - H\u1ea3i Ph\u00f2ng", "kho_tong", "20.8466545", "106.7159715"], ["1260", "Kho LV - Thanh H\u00f3a", "kho_tong", "19.8265373", "105.7659269"], ["1264", "Kho LV - Vinh", "kho_tong", "18.7061732", "105.6536771"], ["1265", "S\u00e2n bay \u0110i\u1ec7n Bi\u00ean Ph\u1ee7", "kho_tong", "21.401058", "103.006704"], ["1266", "S\u00e2n bay Th\u1ecd Xu\u00e2n", "kho_tong", "19.8931021", "105.4718874"], ["1267", "S\u00e2n bay Vinh", "kho_tong", "18.7275265", "105.6664024"], ["1268", "Kho LV - \u0110\u00e0 N\u1eb5ng", "kho_tong", "16.0596466", "108.1633736"], ["1270", "S\u00e2n bay Ph\u00f9 C\u00e1t", "kho_tong", "13.9524341", "109.0454656"], ["1271", "S\u00e2n bay Tuy H\u00f2a", "kho_tong", "13.0492935", "109.309982"], ["1272", "S\u00e2n bay Pleiku", "kho_tong", "14.0066961", "108.003863"], ["1274", "S\u00e2n bay C\u00f4n \u0110\u1ea3o", "kho_tong", "8.7312349", "106.6265189"], ["1275", "S\u00e2n bay R\u1ea1ch Gi\u00e1", "kho_tong", "9.961179", "105.1313871"], ["1276", "S\u00e2n bay Ph\u00fa Qu\u1ed1c", "kho_tong", "10.1634153", "103.9958363"], ["1277", "Kho LV - Thu\u1eadn An", "kho_tong", "10.917325", "106.6658363"], ["1368", "S\u00e2n bay Ph\u00fa B\u00e0i", "kho_tong", "16.398349", "107.69817"], ["1369", "S\u00e2n bay Chu Lai", "kho_tong", "15.4144087", "108.7016226"], ["1373", "S\u00e2n bay C\u00e0 Mau", "kho_tong", "9.1759629", "105.1735035"]] ;
                var egdeList = [["229", "274", "road"], ["274", "229", "road"], ["617", "657", "road"], ["657", "617", "road"], ["705", "617", "road"], ["617", "705", "road"], ["1260", "657", "road"], ["657", "1260", "road"], ["1264", "657", "road"], ["657", "1264", "road"], ["1256", "657", "road"], ["657", "1256", "road"], ["705", "617", "road"], ["705", "657", "road"], ["617", "705", "road"], ["657", "705", "road"], ["1121", "229", "road"], ["1121", "241", "road"], ["1121", "247", "road"], ["1121", "262", "road"], ["1121", "274", "road"], ["1121", "286", "road"], ["1121", "1260", "road"], ["1121", "1264", "road"], ["229", "1121", "road"], ["241", "1121", "road"], ["247", "1121", "road"], ["262", "1121", "road"], ["274", "1121", "road"], ["286", "1121", "road"], ["1256", "1121", "road"], ["1260", "1121", "road"], ["1264", "1121", "road"], ["705", "657", "road"], ["657", "705", "road"], ["1277", "1121", "road"], ["1121", "1277", "road"]];

                // creat graph
                var graph = Viva.Graph.graph();
                nodeList.forEach(function(item) {
                    if(item[2] == "kho_tong")
                        // graph.addNode(item[0], item[1]).isPinned = true ;
                        graph.addNode(item[0], {name: item[1], type: item[2], vido: item[3], kinhdo: item[4]});
                    // else
                    //     graph.addNode(item[0], item[1]) ;
                    
                });

                egdeList.forEach(function(item){
                    graph.addLink(item[0], item[1], item[2]) ;
                });

                
                
                
                var layout = Viva.Graph.Layout.forceDirected(graph, {
                   springLength : 10,
                   springCoeff : 0.0008,
                   dragCoeff : 0.02,
                   gravity : -1.2
                });
                
                 // Load Data
                
                var graphics = Viva.Graph.View.svgGraphics();

                // Node pinning is an attribute, which tells layout algorithm
                // to not update node's position. Effectively the node looks
                // like it is pinned to the canvas.

                // You can pin/unpin node any time you want:
                graphics.node(function (node) {
                    var ui = Viva.Graph.svg("rect")
                         .attr("width", 10)
                         .attr("height", 10)
                         .attr("fill", "#00a2e8");
                    ui.addEventListener('click', function () {
                        // toggle pinned mode
                        layout.pinNode(node, !layout.isNodePinned(node));
                    });
                    return ui;
                });

                var renderer = Viva.Graph.View.renderer(graph, {
                        layout    : layout,
                        graphics  : graphics,
                        container : document.getElementById('graphContainer')
                    });

                renderer.run();
            }
        </script>
        <style type='text/css'>
            body, svg, #graphContainer {
                height: 100%;
                width: 100%;
                position: absolute;
                margin: 0;
            }
            .label {
                position: absolute;
                top: 10px;
                color: white;
                font-size: 18px;
                left: 10px;
                font-family: Verdana;
            }
        </style>
    </head>
    <body onload="onLoad()" style="background-color: black;">
        <div style="margin-top: 100px;">tesssss</div>
        <div id='graphContainer'></div>
        <span class='label'>Click and drag node to toggle its pinning attribute.</span>
    </body>
</html>
